#include <stdio.h>
#include <stdlib.h>
#include "colors.h"

void Analizar_Trama(unsigned char []);
void Analizar_Trama_IP(unsigned char []);
void Analizar_Trama_LLC(unsigned char []);
void Analizar_Trama_ARP(unsigned char []);
unsigned short int checksum(unsigned char t[], unsigned char cs, unsigned char tam, unsigned char i, unsigned char YON);
void UDP(unsigned char *T, unsigned char finIP);
void Analizar_Trama_ICMP(unsigned char []);
void Analizar_Trama_TCP(unsigned char []);
void Analizar_Trama_UDP(unsigned char []);

void main(void){
	unsigned char T[][200]=
		{ {0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x03,0xf0,0xf0,
			0x7f,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x43,0x05,0x90,0x6d}, //trama1
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x03,0xf0,0xf1,
			0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x54,0x90,0x6d}, //trama2
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf0,
			0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x41,0xa3,0x90,0x6d}, //trama3
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
			0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xf2,0x90,0x6d}, //trama4
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
			0x00,0x01,0x0e,0x00,0xff,0xef,0x19,0x8f,0xbc,0x05,0x7f,0x00,0x23,0x00,0x7f,0x23,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x41,0x91,0x6d}, //trama5
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x12,0xf0,0xf0,
			0x00,0x03,0x0e,0x00,0xff,0xef,0x17,0x81,0xbc,0x05,0x23,0x00,0x7f,0x00,0x23,0x7f,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x91,0x6d}, //trama6
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
			0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xdf,0x91,0x6d}, //trama7
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
			0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0xac,0x92,0x6d}, //trama8
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0xac,0xf0,0xf0,
			0x02,0x02,0x0e,0x00,0xff,0xef,0x16,0x04,0x00,0x00,0x00,0x00,0x28,0x00,0x7f,0x23,
			0xff,0x53,0x4d,0x42,0x72,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x09,
			0x00,0x77,0x00,0x02,0x50,0x43,0x20,0x4e,0x45,0x54,0x57,0x4f,0x52,0x4b,0x20,0x50,
			0x52,0x4f,0x47,0x52,0x41,0x4d,0x20,0x31,0x2e,0x30,0x00,0x02,0x4d,0x49,0x43,0x52,
			0x4f,0x53,0x4f,0x46,0x54,0x20,0x4e,0x45,0x54,0x57,0x4f,0x52,0x4b,0x53,0x20,0x33,
			0x2e,0x30,0x00,0x02,0x44,0x4f,0x53,0x20,0x4c,0x4d,0x31,0x2e,0x32,0x58,0x30,0x30,
			0x32,0x00,0x02,0x44,0x4f,0x53,0x20,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x32,0x2e,0x31,
			0x00,0x02,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x66,0x6f,0x72,0x20,0x57,0x6f,
			0x72,0x6b,0x67,0x72,0x6f,0x75,0x70,0x73,0x20,0x33,0x2e,0x31,0x61,0x00,0x02,0x4e,
			0x54,0x20,0x4c,0x4d,0x20,0x30,0x2e,0x31,0x32,0x00,0x00,0xfb,0x92,0x6d,0x86,0xdf}, //trama9
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
			0x01,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7b,0x93,0x6d}, //trama10
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x5f,0xf0,0xf0,
			0x02,0x04,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x23,0x7f,
			0xff,0x53,0x4d,0x42,0x72,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x09,
			0x11,0x05,0x00,0x02,0x02,0x00,0x01,0x00,0x68,0x0b,0x00,0x00,0x00,0x00,0x01,0x00,
			0x7f,0x07,0x00,0x80,0x03,0x02,0x00,0x00,0x00,0xe5,0xfe,0x29,0x25,0x7c,0xc2,0x01,
			0x2c,0x01,0x08,0x08,0x00,0x7f,0x07,0x00,0x80,0x32,0x3e,0xb9,0x3d,0x00,0xca,0x93}, //trama11
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
			0x01,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7c,0x94,0x6d}, //trama12
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x91,0xf0,0xf0,
			0x04,0x04,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23,
			0xff,0x53,0x4d,0x42,0x73,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x09,
			0x0d,0x75,0x00,0x5d,0x00,0x68,0x0b,0x02,0x00,0x00,0x00,0x7f,0x07,0x00,0x80,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x45,
			0x53,0x43,0x4f,0x4d,0x00,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x34,0x2e,0x30,
			0x00,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x34,0x2e,0x30,0x00,0x04,0xff,0x00,
			0x00,0x00,0x02,0x00,0x02,0x00,0x17,0x00,0x20,0x00,0x5c,0x5c,0x50,0x52,0x4f,0x47,
			0x59,0x44,0x45,0x53,0x41,0x5c,0x49,0x50,0x43,0x24,0x00,0x49,0x50,0x43,0x00,0x00}, //trama13
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
			0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x32,0x95,0x6d}, //trama14
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x46,0xf0,0xf0,
			0x04,0x06,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x23,0x7f,
			0xff,0x53,0x4d,0x42,0x73,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x82,0x09,
			0x03,0x75,0x00,0x29,0x00,0x00,0x00,0x00,0x00,0x02,0xff,0x00,0x00,0x00,0x04,0x00,
			0x49,0x50,0x43,0x00,0x00,0x81,0x95,0x6d,0x86,0xcb,0x94,0x6d,0x86,0x0d,0x09,0x0e}, //trama15
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
			0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x96,0x6d}, //trama16
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x7e,0xf0,0xf0,
			0x06,0x06,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23,
			0xff,0x53,0x4d,0x42,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x82,0x0a,
			0x0e,0x20,0x00,0x00,0x00,0x08,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x88,0x13,0x00,
			0x00,0x00,0x00,0x20,0x00,0x4c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2d,0x00,0x5c,
			0x50,0x49,0x50,0x45,0x5c,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x00,0x68,0x00,0x57,0x72,
			0x4c,0x65,0x68,0x44,0x7a,0x00,0x42,0x31,0x36,0x42,0x42,0x44,0x7a,0x00,0x01,0x00,
			0x00,0x10,0xff,0xff,0xff,0xff,0x45,0x53,0x43,0x4f,0x4d,0x00,0x00,0x6f,0x96,0x6d}, //trama17
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
			0x01,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xbe,0x96,0x6d}, //trama18
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
			0x01,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x5d,0x97,0x6d}, //trama19
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x7e,0xf0,0xf0,
			0x08,0x08,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23,
			0xff,0x53,0x4d,0x42,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x02,0x0b,
			0x0e,0x20,0x00,0x00,0x00,0x08,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x88,0x13,0x00,
			0x00,0x00,0x00,0x20,0x00,0x4c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2d,0x00,0x5c,
			0x50,0x49,0x50,0x45,0x5c,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x00,0x68,0x00,0x57,0x72,
			0x4c,0x65,0x68,0x44,0x7a,0x00,0x42,0x31,0x36,0x42,0x42,0x44,0x7a,0x00,0x01,0x00,
			0x00,0x10,0x00,0x00,0x00,0x80,0x45,0x53,0x43,0x4f,0x4d,0x00,0x00,0xac,0x97,0x6d}, //trama20
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
			0x01,0x0a,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xfb,0x97,0x6d}, //trama21
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
			0x01,0x0a,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x4a,0x98,0x6d}, //trama22
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
			0x0a,0x0b,0x0e,0x00,0xff,0xef,0x14,0x00,0x00,0x00,0x28,0x00,0x00,0x00,0x7f,0x23,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x99,0x98,0x6d}, //trama23
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
			0x01,0x0d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x45,0x99,0x6d}, //trama24
			{0x03,0x00,0x00,0x00,0x00,0x01,0x00,0x04,0xac,0x44,0x4d,0x02,0x00,0x8b,0xf0,0xf0,
			0x03,0x2c,0x00,0xff,0xef,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x42,0x34,0x20,
			0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x1b,0x49,0x42,0x4d,
			0x53,0x45,0x52,0x56,0x45,0x52,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0xff,0x53,0x4d,
			0x42,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x00,0x00,
			0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xe8,0x03,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x06,0x00,0x56,0x00,0x03,0x00,0x01,0x00,0x01,0x00,0x02,0x00,
			0x17,0x00,0x5c,0x4d,0x41,0x49,0x4c,0x53,0x4c,0x4f,0x54,0x5c,0x42,0x52,0x4f,0x57,
			0x53,0x45,0x00,0x09,0x04,0x33,0x17,0x00,0x00,0x00,0x9b,0x99,0x6d,0x86,0x99,0x98}, //trama25
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x35,0xf0,0xf0,
			0x0c,0x0a,0x0e,0x00,0xff,0xef,0x16,0x04,0x00,0x00,0x00,0x00,0x28,0x00,0x7f,0x23,
			0xff,0x53,0x4d,0x42,0x71,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x01,0x50,
			0x00,0x00,0x00,0x45,0xf1,0x99,0x6d,0x86,0x45,0x99,0x6d,0x86,0x1f,0x09,0x52,0x5b}, //trama26
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x35,0xf0,0xf0,
			0x0a,0x0e,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x23,0x7f,
			0xff,0x53,0x4d,0x42,0x71,0x00,0x00,0x00,0x00,0x80,0x01,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x01,0x50,
			0x00,0x00,0x00,0x00,0x40,0x9a,0x6d,0x86,0x9b,0x99,0x6d,0x86,0x20,0x09,0x75,0x5b}, //trama27
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
			0x0e,0x0d,0x0e,0x00,0xff,0xef,0x14,0x00,0x00,0x00,0x28,0x00,0x00,0x00,0x7f,0x23,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x8f,0x9a,0x6d}, //trama28
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
			0x01,0x11,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xde,0x9a,0x6d}, //trama29
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
			0x10,0x0d,0x0e,0x00,0xff,0xef,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7f,0x23,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2d,0x9b,0x6d}, //trama30
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
			0x01,0x13,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7c,0x9b,0x6d}, //trama31
			{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x03,0xf0,0xf0,
			0x53,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xcb,0x9b,0x6d}, //trama32
			{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x03,0xf0,0xf1,
			0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x77,0x9c,0x6d}, //trama33
			{0xff,0xff,0xff,0xff,0xff,0xff,0x00,0x23,0x8b,0x46,0xe9,0xad,0x08,0x06,0x00,0x04, 
			0x08,0x00,0x06,0x04,0x00,0x01,0x00,0x23,0x8b,0x46,0xe9,0xad,0x94,0xcc,0x39,0xcb, 
			0x00,0x00,0x00,0x00,0x00,0x00,0x94,0xcc,0x39,0xfe },						   /*Trama a */
			{0x00,0x23,0x8b,0x46,0xe9,0xad,0x00,0x1f,0x45,0x9d,0x1e,0xa2,0x08,0x06,0x00,0x01,  /*TRAMA b */
			0x08,0x00,0x06,0x04,0x00,0x02,0x00,0x1f,0x45,0x9d,0x1e,0xa2,0x94,0xcc,0x39,0xfe,
			0x00,0x23,0x8b,0x46,0xe9,0xad,0x94,0xcc,0x39,0xcb,0x00,0x00,0x00,0x00,0x00,0x00,
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
			{0x00,0x1f,0x45,0x9d,0x1e,0xa2,0x00,0x23,0x8b,0x46,0xe9,0xad,0x08,0x00,0x46,0x00, /* TRAMA c 36*/
			0x80,0x42,0x04,0x55,0x34,0x11,0x80,0x11,0x6b,0xf0,0x94,0xcc,0x39,0xcb,0x94,0xcc, 
			0x67,0x02,0xaa,0xbb,0xcc,0xdd,0x04,0x0c,0x00,0x35,0x00,0x2e,0x85,0x7c,0xe2,0x1a,
			0x01,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x77,0x77,0x77,0x03,0x69,
			0x73,0x63,0x05,0x65,0x73,0x63,0x6f,0x6d,0x03,0x69,0x70,0x6e,0x02,0x6d,0x78,0x00,
			0x00,0x1c,0x00,0x01},
			{0xff,0xff,0xff,0xff,0xff,0xff,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x08,0x06,0x00,0x01,
			0x08,0x00,0x06,0x04,0x00,0x01,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xc0,0xa8,0x01,0x01,
			0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x01},//37
			{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x23, 
			0x8b, 0x46, 0xe9, 0xad, 0x08, 0x06, 0x00, 0x04, 
			0x08, 0x00, 0x06, 0x04, 0x00, 0x01, 0x00, 0x23, 
			0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x94, 0xcc, 
			0x39, 0xfe},//38
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 
			0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x06, 0x00, 0x01, 
			0x08, 0x00, 0x06, 0x04, 0x00, 0x02, 0x00, 0x1f, 
			0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x39, 0xfe, 
			0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 
			0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00},//39
			{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 
			0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x46, 0x00, 
			0x80, 0x42, 0x04, 0x55, 0x34, 0x11, 0x80, 0x11, 
			0x6b, 0xf0, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, 
			0x67, 0x02, 0xaa, 0xbb, 0xcc, 0xdd, 0x04, 0x0c, 
			0x00, 0x35, 0x00, 0x2e, 0x85, 0x7c, 0xe2, 0x1a,
			0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69, 
			0x73, 0x63, 0x05, 0x65, 0x73, 0x63, 0x6f, 0x6d, 
			0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00, 
			0x00, 0x1c, 0x00, 0x01},//40
			{0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x04, 0xf0, 0xf1,
			0x09, 0x8d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x9b, 0x6d},//41
			{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x23, 
			0x8b, 0x46, 0xe9, 0xad, 0x08, 0x06, 0x00, 0x10, 
			0x08, 0x00, 0x06, 0x04, 0x00, 0x03, 0x00, 0x23, 
			0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x94, 0xcc, 
			0x3a, 0xe1},//42
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 
			0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x06, 0x00, 0x10, 
			0x08, 0x00, 0x06, 0x04, 0x00, 0x04, 0x00, 0x1f, 
			0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x3a, 0xe1, 
			0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 
			0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00},//43
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 
			0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x6f, 0x90, 0x30, 0x40, 0x00, 0xfb, 0x11, 
			0x24, 0xe7, 0x94, 0xcc, 0x67, 0x02, 0x94, 0xcc, 
			0x39, 0xcb, 0x00, 0x35, 0x04, 0x0c, 0x00, 0x5b, 
			0xe8, 0x60, 0xe2, 0x1a, 0x85, 0x80, 0x00, 0x01, 
			0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x03, 0x77, 
			0x77, 0x77, 0x03, 0x69, 0x73, 0x63, 0x05, 0x65, 
			0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 
			0x02, 0x6d, 0x78, 0x00, 0x00, 0x1c, 0x00, 0x01, 
			0xc0, 0x14, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 
			0x0e, 0x10, 0x00, 0x21, 0x04, 0x64, 0x6e, 0x73, 
			0x31, 0xc0, 0x1a, 0x03, 0x74, 0x69, 0x63, 0xc0, 
			0x1a, 0x77, 0xec, 0xdf, 0x29, 0x00, 0x00, 0x2a, 
			0x30, 0x00, 0x00, 0x0e, 0x10, 0x00, 0x12, 0x75, 
			0x00, 0x00, 0x00, 0x2a, 0x30},//44
			{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 
			0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x42, 0x04, 0x56, 0x00, 0x00, 0x80, 0x11, 
			0x6b, 0xef, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, 
			0x67, 0x02, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, 
			0xff, 0x87, 0x68, 0x2a, 0x01, 0x00, 0x00, 0x01, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, 
			0x77, 0x77, 0x03, 0x69, 0x73, 0x63, 0x05, 0x65, 
			0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 
			0x02, 0x6d, 0x78, 0x00, 0x00, 0x01, 0x00, 0x01},//45
			{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 
			0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x3c, 0x04, 0x57, 0x00, 0x00, 0x80, 0x01, 
			0x98, 0x25, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, 
			0x3a, 0xe1, 0x08, 0x00, 0x49, 0x5c, 0x03, 0x00, 
			0x01, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 
			0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 
			0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 
			0x77, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 
			0x68, 0x69},//46
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 
			0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x3c, 0x01, 0xb5, 0x00, 0x00, 0x3f, 0x01, 
			0xdb, 0xc7, 0x94, 0xcc, 0x3a, 0xe1, 0x94, 0xcc, 
			0x39, 0xcb, 0x00, 0x00, 0x51, 0x5c, 0x03, 0x00, 
			0x01, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 
			0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 
			0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 
			0x77, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 
			0x68, 0x69 },//47
			{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x1c, 
			0xc0, 0x7b, 0x35, 0xa1, 0x08, 0x00, 0x48, 0x00, 
			0x00, 0x48, 0x5c, 0x7d, 0x00, 0x00, 0x80, 0x01, 
			0x6c, 0x88, 0x94, 0xcc, 0x39, 0xc3, 0x94, 0xcc, 
			0x00, 0x49, 0x07, 0x0b, 0x04, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 
			0x3b, 0x5c, 0x02, 0x00, 0x10, 0x00, 0x61, 0x62, 
			0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6a, 
			0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, 
			0x73, 0x74, 0x75, 0x76, 0x77, 0x61, 0x62, 0x63, 
			0x64, 0x65, 0x66, 0x67, 0x68, 0x69},//48
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 
			0x45, 0x9d, 0x1e, 0xa2, 0x80, 0x35, 0x00, 0x01, 
			0x08, 0x00, 0x06, 0x04, 0x00, 0x03, 0x00, 0x1f, 
			0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x3a, 0xe1, 
			0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 
			0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0xd8, 0xee, 0xdf, 0xb0},//49
			{0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, 
			0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x03, 0xf0, 0xf0, 
			0x7f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x43, 0x05, 0x90, 0x6d},//50
			{0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x00, 0xff, 
			0x66, 0x7f, 0xd4, 0x3c, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x30, 0x2c, 0x00, 0x40, 0x00, 0x80, 0x06, 
			0x4b, 0x74, 0xc0, 0xa8, 0x01, 0x02, 0xc0, 0xa8, 
			0x01, 0x01, 0x04, 0x03, 0x00, 0x15, 0x00, 0x3b, 
			0xcf, 0x44, 0x00, 0x00, 0x00, 0x00, 0x50, 0x20, 
			0x20, 0x00, 0x0c, 0x34, 0x00, 0x00, 0x02, 0x04, 
			0x05, 0xb4, 0x01, 0x01, 0x04, 0x02},//51
			{0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x02, 0xff, 
			0x53, 0xc3, 0xe9, 0xab, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x30, 0x05, 0xc4, 0x40, 0x00, 0x80, 0x06, 
			0x71, 0xb0, 0xc0, 0xa8, 0x01, 0x01, 0xc0, 0xa8, 
			0x01, 0x02, 0x00, 0x15, 0x04, 0x03, 0x21, 0x5d, 
			0x3a, 0x44, 0x00, 0x3b, 0xcf, 0x45, 0x70, 0x12, 
			0x44, 0x70, 0x8c, 0x11, 0x00, 0x00, 0x02, 0x04, 
			0x05, 0xb4, 0x01, 0x01, 0x04, 0x02},//52
			{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x06, 0x00, 0x10,
			0x08, 0x00, 0x06, 0x04, 0x00, 0x04, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x94, 0xcc, 0x39, 0xfe},//53
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x06, 0x00, 0x01, 
			0x08, 0x00, 0x06, 0x04, 0x00, 0x02, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x39, 0xfe, 
			0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },//54
			{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x46, 0x00, 
			0x80, 0x42, 0x04, 0x55, 0x34, 0x11, 0x80, 0x11, 0x6b, 0xf0, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, 
			0x67, 0x02, 0xaa, 0xbb, 0xcc, 0xdd, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, 0x85, 0x7c, 0xe2, 0x1a, 
			0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69, 
			0x73, 0x63, 0x05, 0x65, 0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00, 
			0x00, 0x1c, 0x00, 0x01},//55
			{ 0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x04, 0xf0, 0xf1, 
			0x09, 0x8d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x9b, 0x6d},//56
			{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x06, 0x00, 0x10, 
			0x08, 0x00, 0x06, 0x04, 0x00, 0x03, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x94, 0xcc, 0x3a, 0xe1},//57
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x06, 0x00, 0x10, 
			0x08, 0x00, 0x06, 0x04, 0x00, 0x04, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x3a, 0xe1, 
			0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},//58
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x6f, 0x90, 0x30, 0x40, 0x00, 0xfb, 0x11, 0x24, 0xe7, 0x94, 0xcc, 0x67, 0x02, 0x94, 0xcc,
			0x39, 0xcb, 0x00, 0x35, 0x04, 0x0c, 0x00, 0x5b, 0xe8, 0x60, 0xe2, 0x1a, 0x85, 0x80, 0x00, 0x01, 
			0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69, 0x73, 0x63, 0x05, 0x65, 
			0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00, 0x00, 0x1c, 0x00, 0x01, 
			0xc0, 0x14, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x0e, 0x10, 0x00, 0x21, 0x04, 0x64, 0x6e, 0x73, 
			0x31, 0xc0, 0x1a, 0x03, 0x74, 0x69, 0x63, 0xc0, 0x1a, 0x77, 0xec, 0xdf, 0x29, 0x00, 0x00, 0x2a, 
			0x30, 0x00, 0x00, 0x0e, 0x10, 0x00, 0x12, 0x75, 0x00, 0x00, 0x00, 0x2a, 0x30},//59
			{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x42, 0x04, 0x56, 0x00, 0x00, 0x80, 0x11, 0x6b, 0xef, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, 
			0x67, 0x02, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, 0xff, 0x87, 0x68, 0x2a, 0x01, 0x00, 0x00, 0x01, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69, 0x73, 0x63, 0x05, 0x65, 
			0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00, 0x00, 0x01, 0x00, 0x01},//60
			{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x3c, 0x04, 0x57, 0x00, 0x00, 0x80, 0x01, 0x98, 0x25, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, 
			0x3a, 0xe1, 0x08, 0x00, 0x49, 0x5c, 0x03, 0x00, 0x01, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 
			0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 
			0x77, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69},//61
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x3c, 0x01, 0xb5, 0x00, 0x00, 0x3f, 0x01, 0xdb, 0xc7, 0x94, 0xcc, 0x3a, 0xe1, 0x94, 0xcc, 
			0x39, 0xcb, 0x00, 0x00, 0x51, 0x5c, 0x03, 0x00, 0x01, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 
			0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 
			0x77, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69},//62
			{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x1c, 0xc0, 0x7b, 0x35, 0xa1, 0x08, 0x00, 0x48, 0x00,  
			0x00, 0x48, 0x5c, 0x7d, 0x00, 0x00, 0x80, 0x01, 0x6c, 0x88, 0x94, 0xcc, 0x39, 0xc3, 0x94, 0xcc, 
			0x00, 0x49, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x06, 0x05, 0x04, 0x03, 0x02, 0x01, 0x08, 0x00, 
			0x3b, 0x5c, 0x02, 0x00, 0x10, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6a, 
			0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x61, 0x62, 0x63, 
			0x64, 0x65, 0x66, 0x67, 0x68, 0x69},//63
			{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x80, 0x35, 0x00, 0x01, 
			0x08, 0x00, 0x06, 0x04, 0x00, 0x03, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x3a, 0xe1, 
			0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xd8, 0xee, 0xdf, 0xb0},//64
			{0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x03, 0xf0, 0xf0, 
			0x53, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x43, 0x05, 0x90, 0x6d},//65
			{0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x30, 0x2c, 0x00, 0x40, 0x00, 0x80, 0x06, 0x4b, 0x74, 0xc0, 0xa8, 0x01, 0x02, 0xc0, 0xa8, 
			0x01, 0x01, 0x04, 0x03, 0x00, 0x15, 0x00, 0x3b, 0xcf, 0x44, 0x00, 0x00, 0x00, 0x00, 0x50, 0x20, 
			0x20, 0x00, 0x0c, 0x34, 0x00, 0x00, 0x02, 0x04, 0x05, 0xb4, 0x01, 0x01, 0x04, 0x02},//66
			{0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x08, 0x00, 0x45, 0x00, 
			0x00, 0x30, 0x05, 0xc4, 0x40, 0x00, 0x80, 0x06, 0x71, 0xb0, 0xc0, 0xa8, 0x01, 0x01, 0xc0, 0xa8, 
			0x01, 0x02, 0x00, 0x15, 0x04, 0x03, 0x21, 0x5d, 0x3a, 0x44, 0x00, 0x3b, 0xcf, 0x45, 0x70, 0x12, 
			0x44, 0x70, 0x8c, 0x11, 0x00, 0x00, 0x02, 0x04, 0x05, 0xb4, 0x01, 0x01, 0x04, 0x02}//67
		};

	unsigned char a;
	for(a=1;a<=67;a++){
		printf("Trama #%d\n",a);
		Analizar_Trama(T[a-1]);
	}
}

void Analizar_Trama_UDP(unsigned char *T){
	unsigned char Tam_cabecera = (T[14]&15)*4;
	printf("%s+++Cabecera UDP+++%s\n",KBLU,KNRM);
		printf("Puerto de origen: ");
		switch ((T[34+((Tam_cabecera-20)/4)]<<8)|T[35+((Tam_cabecera-20)/4)]){
			case 7:
				printf("echo\n");
				break;
			case 19:
				printf("chargen\n");
				break;
			case 37:
				printf("time\n");
				break;
			case 53:
				printf("domain\n");
				break;
			case 67:
				printf("bootps\n");
				break;
			case 68:
				printf("bootpc\n");
				break;
			case 69:
				printf("tftp\n");
				break;
			case 137:
				printf("netbios-ns\n");
				break;
			case 138:
				printf("netbios-dgm\n");
				break;
			case 161:
				printf("snmp\n");
				break;
			case 162:
				printf("snmp-trap\n");
				break;
			case 500:
				printf("isakmp\n");
				break;
			case 514:
				printf("syslog\n");
				break;
			case 520:
				printf("rip\n");
				break;
			case 33434:
				printf("traceroute\n");
				break;
			default:
				printf("Otro\n");
				break;
		}
		printf("Puerto de Destino: ");
		switch ((T[36+((Tam_cabecera-20)/4)]<<8)|T[37+((Tam_cabecera-20)/4)]){
			case 7:
				printf("echo\n");
				break;
			case 19:
				printf("chargen\n");
				break;
			case 37:
				printf("time\n");
				break;
			case 53:
				printf("domain\n");
				break;
			case 67:
				printf("bootps\n");
				break;
			case 68:
				printf("bootpc\n");
				break;
			case 69:
				printf("tftp\n");
				break;
			case 137:
				printf("netbios-ns\n");
				break;
			case 138:
				printf("netbios-dgm\n");
				break;
			case 161:
				printf("snmp\n");
				break;
			case 162:
				printf("snmp-trap\n");
				break;
			case 500:
				printf("isakmp\n");
				break;
			case 514:
				printf("syslog\n");
				break;
			case 520:
				printf("rip\n");
				break;
			case 33434:
				printf("traceroute\n");
				break;
			default:
				printf("Otro\n");
				break;
		}
		printf("Lenght %d bytes\n",(unsigned short)((T[38+((Tam_cabecera-20)/4)]<<8)|T[39+((Tam_cabecera-20)/4)]));
		
		UDP(T,(33+(((T[14]&15)*4)-20)));
		
		printf("\nFin de UDP\n");
}
void Analizar_Trama_ICMP(unsigned char *T){
	unsigned char Tam_cabecera = (T[14]&15)*4;
		printf("%s+++Cabecera ICMP+++%s\n",KBLU,KNRM);

	switch (T[14+(Tam_cabecera)]){
		case 0:
			printf("Type : Echo Reply\n");
			printf("Code : %d \n",T[15+(Tam_cabecera)]);
			break;
		case 3:
			printf("Type : Destinination unreachable\n");
			printf("Code : %d \n",T[15+(Tam_cabecera)]);
			break;
		case 4:
			printf("Type : Source Quench\n");
			printf("Code : %d \n",T[15+(Tam_cabecera)]);
			break;
		case 5:
			printf("Type : Redirect\n");
			printf("Code : %d \n",T[15+(Tam_cabecera)]);
			break;
		case 8:
			printf("Type : Echo \n");
			printf("Code : %d \n",T[15+(Tam_cabecera)]);
			break;
		default:
			printf("Type :  Otro %d\n",T[14+(Tam_cabecera)]);
			printf("Code : %d \n",T[15+(Tam_cabecera)]);
			break;
	}
	printf("CheckSum: %.4x\n",(unsigned short)(T[16+(Tam_cabecera)]<<8|T[17+(Tam_cabecera)]));
	
}
void Analizar_Trama_TCP(unsigned char *T){
	printf("%s+++Cabecera TCP+++%s\n",KRED,KNRM);
	unsigned char Tam_cabecera_IP = (T[14]&15)*4;
	unsigned char Tam_cabecera_TCP = (T[(26+(Tam_cabecera_IP))]>>4)*4;
	unsigned char a;
	printf("Offset: %d bytes\n",Tam_cabecera_TCP);
	printf("Flags: ");
	if(T[27+(Tam_cabecera_IP)]&1){
		printf("F:Finish");
	}
	if(T[27+(Tam_cabecera_IP)]&2){
		printf("S:Syn");
	}
	if(T[27+(Tam_cabecera_IP)]&4){
		printf("R:Reset");
	}
	if(T[27+(Tam_cabecera_IP)]&8){
		printf("P:Push");
	}
	if(T[27+(Tam_cabecera_IP)]&16){
		printf("A:Ackowledge");
	}
	if(T[27+(Tam_cabecera_IP)]&32){
		printf("U:Urgent");
	}
	printf("\n");

	if (Tam_cabecera_TCP>20 && Tam_cabecera_TCP<=60){
		printf("Opciones: ");
		for(a=34+Tam_cabecera_IP;a<=33+Tam_cabecera_IP+(Tam_cabecera_TCP-20);a++){
			printf("%.2X ",T[a]);
		}printf("\n");

	}
}
void Analizar_Trama_IP(unsigned char *T){
    printf("%s+++Cabecera IP+++%s\n",KBLU,KNRM);
	unsigned char Tam_cabecera = (T[14]&15)*4;
	unsigned char a;
	if ((T[14]>>4)!=4 && (T[14]>>4)!=6){
		perror("No se detecto una version de IP valida");
	}else{
		printf("Version: %d\n",T[14]>>4); 
		printf("Tamaño : %d bytes\n",Tam_cabecera);
		if(Tam_cabecera<20 && Tam_cabecera>60)
			perror("Tamaño de la cabecera invalido");
	}
	//Tipo de servicio
	switch (T[15]>>5){
		case 0:printf("Prioridad del Servicio: \"De rutina\"\n");
				break;
		case 1:printf("Prioridad del Servicio: \"Prioritario\"\n");
				break;
		case 2:printf("Prioridad del Servicio: \"Inmediato\"\n");
				break;
		case 3:printf("Prioridad del Servicio: \"Relampago\"\n");
				break;
		case 4:printf("Prioridad del Servicio: \"Invalidacion Relampago\"\n");
				break;
		case 5:printf("Prioridad del Servicio: \"Procesando llamada crítica y de emergencia\"\n");
				break;
		case 6:printf("Prioridad del Servicio: \"Control de trabajo de Internet\"\n");
				break;
		case 7:printf("Prioridad del Servicio: \"Control de red\"\n");
				break;
	}
	if (T[15]&16){
		printf("El retardo es Bajo\n");
	}else{
		printf("El retardo es Normal\n");
	}
	if (T[15]&8){
		printf("El Rendimiento es Alto\n");
	}else{
		printf("El Rendimiento es Normal\n");
	}
	if (T[15]&4){
		printf("La Fiabilidad es Alta\n");
	}else{
		printf("La Fiabilidad es Normal\n");
	}
	if (T[15]&2){
	 	printf("El costo es minimo\n");
	}else{
		printf("ECJ capable\n");
	}
	if (T[15]&1){
		printf("Experimento congestion\n");
	}else{
		printf("Reservado normalmente 0\n");
	}
	printf("La longitud Total es: %d\n",((T[16]<<8)|T[17]));
	printf("El identificador es: %d\n",((T[18]<<8)|T[19]));            
	//Flags
	if ((T[20]&128)==128){
		perror("Este bit es reservado, debe ser 0\n");
	}else{
		printf("El bit es 0, es reservado\n");
	}
	if ((T[20]&64)==64){
		printf("No Fragmentado\n");
	}else{
		printf("Fragmentado\n");
	}
	if ((T[20]&32)==32){
		printf("Fragmento intermedio\n");
	}else{
		printf("Fragmento final\n");
	}
	printf("Posicion de Fragmento: %d\n",((T[20]<<3)||T[21]));
	printf("Tiempo de Vida(TTL): %d\n",T[22]);

	//Protocolo siguiente
	switch (T[23]){
	case 1:
		printf("El protocolo siguiente: ICMP \n");
		
		break;
	case 2:
		printf("El protocolo siguiente: IGMP \n");
		break;
	case 6:
		printf("El protocolo siguiente: TCP \n");
		//Falta
		break;
	case 9:
		printf("El protocolo siguiente: IGRP \n");
		break;
	case 17:
		printf("El protocolo siguiente: UDP \n");
		
		break;
	case 47:
		printf("El protocolo siguiente: GRE \n");
		break;
	case 50:
		printf("El protocolo siguiente: ESP \n");
		break;
	case 51:
		printf("El protocolo siguiente: AH \n");
		break;
	case 57:
		printf("El protocolo siguiente: SKIP \n");
		break;
	case 88:
		printf("El protocolo siguiente: EIGRP \n");
		break;
	case 89:
		printf("El protocolo siguiente: OSFF \n");
		break;
	case 115:
		printf("El protocolo siguiente: L2TP \n");
		break;
	default:
		printf("El protocolo siguiente: OTRO \n");
		break;
	}
	/*if((unsigned short)((T[24]<<8)|T[25]) != 0){
		if(CheckSum(T,14,13+Tam_cabecera,(unsigned short)((T[24]<<8)|T[25]))==0){
			printf("CheckSum: %.4x\n",(unsigned short)((T[24]<<8)|T[25]) );
			printf("El CheckSum Calculado es %x, La información llego bien \n",CheckSum(T,14,13+Tam_cabecera,(unsigned short)((T[24]<<8)|T[25])));
		}else{
			printf("CheckSum: %.4x\n",(unsigned short)((T[24]<<8)|T[25]) );
			printf("El CheckSum Calculado es %x, La información llego mal \n",CheckSum(T,14,13+Tam_cabecera,(unsigned short)((T[24]<<8)|T[25])));
		}
	}else{
		printf("CheckSum: %.4x\n",(unsigned short)((T[24]<<8)|T[25]) );
		printf("El CheckSum Calculado es %x\n",CheckSum(T,14,13+Tam_cabecera,(unsigned short)((T[24]<<8)|T[25])));
	}*/
	printf("IP Origen:%d.%d.%d.%d\n",T[26],T[27],T[28],T[29]);
	printf("IP Destino:%d.%d.%d.%d\n",T[30],T[31],T[32],T[33]);

		
	if (Tam_cabecera>20 && Tam_cabecera<=60){
		printf("Opciones: ");
		for(a=34;a<=33+(Tam_cabecera-20);a++){
			printf("%.2X ",T[a]);
		}printf("\n");

	}else{
		printf("SIN OPCIONES\n");
	}
	
	
}
void Analizar_Trama_LLC(unsigned char *T){
 unsigned char S[][5]={"RR","RNR","REJ","SREJ"};
 unsigned char MC[][6]={"UI","SIM","","SARM","UP","","","SABM","DISC","","","SARME","","","","SABME","SNRM","","","RSET","","","","XID","","","","SNRME","","","",""};
 unsigned char MR[][6]={"UI","RIM","","DM","","","","","RD","","","","UA","","","","","FRMR","","","","","","XID","","","","","","","",""};
	printf("%s+++Cabecera LLC+++%s\n",KBLU,KNRM);
        switch (T[16]&3){
            case 1:
                printf("%sT-%sS%s",KBLU,KRED,KNRM);
                printf(" %s, N(R) = %d ",S[((T[16]&12)>>2)],T[17]>>1);
                if(T[17]&1){
                    if(T[15]&1){
                        printf(", P/F=F\n");
                    }else{
                        printf(",P/F=P\n");
                    }
                }
                printf("\n");
                break;
            case 3:
                printf("%sT-%sU%s ",KBLU,KRED,KNRM);
                if(T[16]&16){
                    if(T[15]&1){
                        printf("P/F = F, M = %s\n",MR[((T[16]>>2)&3)|((T[16]>>3)&28)]);
                    }else{
                        printf("P/F = P, M = %s\n",MC[((T[16]>>2)&3)|((T[16]>>3)&28)]);
                    }
                }
                printf("\n");
                break;
            default:
                printf("%sT-%sI%s ",KBLU,KRED,KNRM);
                printf("N(S) = %d, N(R) = %d ",T[16]>>1,T[17]>>1);
                if(T[17]&1){
                    if(T[15]&1){
                        printf(", P/F=F\n");
                    }else{
                        printf(",P/F=P\n");
                    }
                }
                printf("\n");
            break;
        }
}
void Analizar_Trama_ARP(unsigned char *T){
	printf("%s+++Cabecera ARP+++%s\n",KBLU,KNRM);
	switch ((short)((T[14]<<8)|T[15])){
		case 1:
			printf("H.A.T.: Ethernet ");
			break;
		case 4:
			printf("H.A.T.: Token Ring ");
			break;
		case 6:
			printf("H.A.T.: IEEE 802 LAN ");
			break;
		case 15:
			printf("H.A.T.: Frame Relay ");
			break;
		case 16:
			printf("H.A.T.: ATM ");
			break;
		default:
			printf("H.A.T:OTRO");
			break;
	}
	printf("\n");
	if(T[16]&8){
		printf("P.A.T.: IPV4\n");
	}
	printf("Longitud Hardware: %d bytes\n",T[18]);
	printf("Longitud Protocolo: %d bytes\n",T[19]);
	switch ((unsigned short)((T[20]<<8)|T[21])){
		case 1:
			printf("Opcode: Request\n");
			break;
		case 2:
			printf("Opcode: Replay\n");
			break;
		case 3:
			printf("Opcode: Inv Request\n");
			break;
		case 4:
			printf("Opcode: Inv Replay\n");
			break;
		default:
			printf("OTRO\n");
			break;
	}
	printf("%sM.A.C %sOrigen%s: %s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s\n",KRED,KBLU,KNRM,KMAG,T[22],KNRM,KMAG,T[23],KNRM,KMAG,T[24],KNRM,KMAG,T[25],KNRM,KMAG,T[26],KNRM,KMAG,T[27],KNRM);
	printf("%s IP %sOrigen%s: %s%d%s.%s%d%s.%s%d%s.%s%d%s\n",KRED,KBLU,KNRM,KMAG,T[28],KNRM,KMAG,T[29],KNRM,KMAG,T[30],KNRM,KMAG,T[31],KNRM);
	printf("%sM.A.C %sBuscada%s: %s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s\n",KRED,KBLU,KNRM,KMAG,T[32],KNRM,KMAG,T[33],KNRM,KMAG,T[34],KNRM,KMAG,T[35],KNRM,KMAG,T[36],KNRM,KMAG,T[37],KNRM);
	printf("%s IP %sBuscada%s: %s%d%s.%s%d%s.%s%d%s.%s%d%s\n",KRED,KBLU,KNRM,KMAG,T[28],KNRM,KMAG,T[29],KNRM,KMAG,T[30],KNRM,KMAG,T[31],KNRM);
}

unsigned short int checksum(unsigned char *t, unsigned char cs, unsigned char tam, unsigned char i, unsigned char YON){
    /* cs-> inicio del checksum, pocision en el arreglo 
       tam-> tama\F1o de la trama IP
       i->fin ethernet, inicio de la suma
       YON->saber si es primera o segunda
	 */

	unsigned int aux=0;
    unsigned char j=i;
   // printf("\t\tCHECKSUM %.2x", t[cs]<<8|t[cs+1]);
    do{
        if(j!=cs)
            aux+=t[j]<<8|t[j+1];
            j+=2;
            
    }while(j<tam+i);
    
    if(YON==0)
    		aux+=t[cs]<<8|t[cs+1];
    
    aux+=(aux>>16);
    aux= ~aux;
    
    return (unsigned short int)aux;
}

void UDP(unsigned char *T, unsigned char finIP){
		unsigned char a;
		unsigned char TRAMUDP[12+(T[finIP+5]<<8|T[finIP+6])]; //VARIABLE NUEVA
				for(a=0; a<=sizeof(TRAMUDP)/sizeof(TRAMUDP[0]); a++)
						TRAMUDP[a]=0;
		
				TRAMUDP[0]=T[26]; //PSEUDOCABCECERA
				TRAMUDP[1]=T[27];
				TRAMUDP[2]=T[28];
				TRAMUDP[3]=T[29]; //SOURCE ADDRESS
				TRAMUDP[4]=T[30];
				TRAMUDP[5]=T[31];
				TRAMUDP[6]=T[32];
				TRAMUDP[7]=T[33]; //Destination address
				TRAMUDP[8]=0x00;
				TRAMUDP[9]=0x08;
				TRAMUDP[10]=T[finIP+5];
				TRAMUDP[11]=T[finIP+6]; //FINPSEUDOCABECERA	
				unsigned char b=12;
			//	printf("TAMANIO %.2x",T[finIP+5]<<8|T[finIP+6] );
				for(a=finIP+1; a<=(T[finIP+5]<<8|T[finIP+6])+finIP; a++){
					TRAMUDP[b]= T[a];
					b++;
				}
		
	//		printf("\n");
			/*	for(a=0; a<=sizeof(TRAMUDP)/sizeof(TRAMUDP[0]); a++)
					printf("%.2x ",TRAMUDP[a]);
			*/
			unsigned short int	checksum1= checksum(TRAMUDP,18,sizeof(TRAMUDP)/sizeof(TRAMUDP[0]),0,0)-9; //CON CHECKSUM
				
					if(checksum1==0x0000) 
						printf("\nEl checksum es: %.2x%.2x ",T[finIP+7],T[finIP+8]);
					else
						printf("\nEl checksum es incorrecto: %.2x%.2x \t el calculado: %.2x",T[finIP+7],T[finIP+8],checksum(TRAMUDP,18,12+(T[finIP+5]<<8|T[finIP+6]),0,1)-9);
				    
}

	
	
	

void Analizar_Trama(unsigned char *T){
 unsigned short Tot=0;
 printf("%s***Cabecera  Ethernet****\n%s",KRED,KNRM);
 printf("%sM.A.C %sDestino%s: %s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s\n",KRED,KBLU,KNRM,KMAG,T[0],KNRM,KMAG,T[1],KNRM,KMAG,T[2],KNRM,KMAG,T[3],KNRM,KMAG,T[4],KNRM,KMAG,T[5],KNRM);
 printf("%sM.A.C %sOrigen%s: %s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s:%s%.2x%s\n",KRED,KBLU,KNRM,KMAG,T[6],KNRM,KMAG,T[7],KNRM,KMAG,T[8],KNRM,KMAG,T[9],KNRM,KMAG,T[10],KNRM,KMAG,T[11],KNRM);

 Tot=(T[12]<<8)|T[13];
    if(Tot<=1500){
        printf("%sTamaño%s :%s %hd bytes\n",KRED,KNRM,KMAG,Tot);
			Analizar_Trama_LLC(T);
     }else{
        if(Tot==2048){
            printf("%sTipo%s :%s IP%s \n",KRED,KNRM,KMAG,KNRM);
            Analizar_Trama_IP(T);
			switch (T[23]){
			case 1:
				
				Analizar_Trama_ICMP(T);
				break;
			case 2:
				break;
			case 6:
				Analizar_Trama_TCP(T);
				break;
			case 9:
				break;
			case 17:
				Analizar_Trama_UDP(T);
				break;
			case 47:
				break;
			case 50:
				break;
			case 51:
				break;
			case 57:
				break;
			case 88:
				break;
			case 89:
				break;
			case 115:
				break;
			default:
				break;
			}
            
        }else{
            if(Tot==2054){
                printf("%sTipo%s :%s ARP%s \n",KRED,KNRM,KMAG,KNRM);
                Analizar_Trama_ARP(T);
            }else{
                printf("%sTipo%s :%s otro%s \n",KRED,KNRM,KMAG,KNRM);
                printf("%s+++Cabecera Otro+++%s\n",KBLU,KNRM);
            }
        }
    }
}
